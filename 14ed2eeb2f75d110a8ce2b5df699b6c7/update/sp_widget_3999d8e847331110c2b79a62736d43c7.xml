<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller = function (spUtil) {
  /* widget controller */
  var c = this;
  c.scheduledJobs = [];
  c.widgetKey = {};
  init();
  function init() {
    var input = {
      action: 'init'
    }

    c.server.get(input).then(function (response) {
      if (response && response.data) {
        var scheduledJobs = response.data.scheduledJobs;
        loadWidgets(scheduledJobs);
      }
    })
  }


  function loadWidgets(scheduledJobs) {

    for (var i = 0; i < scheduledJobs.length; i++) {
      c.scheduledJobs.push({});

      c.widgetKey[scheduledJobs[i].sysId] = c.scheduledJobs.length - 1;
      loadWidget(scheduledJobs[i]);
    }
  }

  function loadWidget(scheduledJob){
    var input ={
      action: 'load_widget',
      options: { 
        scheduled_job_sysid: scheduledJob.sysId, 
        scheduled_job_table: scheduledJob.sysClass
      }
    } 
    c.server.get(input).then(function(response){
      if(response && response.data){
        var widget = response.data.scheduledJobWidget;
        var jobId = widget.options.scheduled_job_sysid;
        c.scheduledJobs[c.widgetKey[jobId]] = widget;

      }
    })
  }


};]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>jobutils_list</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Scheduled Job List</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
 
	
	if(input){
    var controller = new JobUtilsController();
    if(input.action === 'init'){
      data.scheduledJobs = controller.getScheduledJobs();
    }

    if(input.action === 'load_widget'){
      data.scheduledJobWidget = $sp.getWidget("jobutils_card", input.options);
    }

  }
	
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>erik.anderson</sys_created_by>
        <sys_created_on>2022-12-12 16:58:27</sys_created_on>
        <sys_id>3999d8e847331110c2b79a62736d43c7</sys_id>
        <sys_name>Scheduled Job List</sys_name>
        <sys_package display_value="Scheduled Job Utilities" source="x_156954_sch_util">14ed2eeb2f75d110a8ce2b5df699b6c7</sys_package>
        <sys_policy/>
        <sys_scope display_value="Scheduled Job Utilities">14ed2eeb2f75d110a8ce2b5df699b6c7</sys_scope>
        <sys_update_name>sp_widget_3999d8e847331110c2b79a62736d43c7</sys_update_name>
        <template><![CDATA[<div>
<!-- your widget template -->
<!-- <h1>Hello World</h1>
<pre>{{c.scheduledJobs[0] | json}}</pre> -->
<div ng-repeat="scheduledJob in c.scheduledJobs">
    <sp-widget widget="scheduledJob"></sp-widget>
</div>

</div>]]></template>
    </sp_widget>
</record_update>
